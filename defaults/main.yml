---
# file: defaults/main.yml

### Modules
# Configure Burp UI Agent
burp_module_agent: false
# Configure burp restore service
burp_module_restore: false
# Configure Burp manual delete
burp_manual_delete_enabled: false
# Configure Burp Autoupgrade
burp_server_autoupgrade_enabled: false
# Activate clients from git repository
burp_repos: false
#burpsrv_repos:
#  - { repo: "url", version: "branch", dir: "dest dir"}
# Example: 
# burp_repos:
#  - { repo: "http://host/group/repo.git", version: "master", dir: "linux_clients"}
# You just need files per client, example: 
# client1 file content: 
# 
# password = password
# dedup_group = trusty
# . incexc/profile_lnxsrv

burp_module_test_client: false

### ---

burp_home: "/var/spool/burp"

## Build vars:

# Add these vars to your hosts/groups to change version/tag (archive to download and compile)
burpsrcext: "zip"              # must be tar.gz or zip
autoupgrade_version: "2.0.54"  # master version is not compiled so added separately
burp_version: "2.0.54"         # branch or tag, example: "master"  , example: "2.0.46"

burp_force_reinstall: false

# previously:  burpsrc: "burp-2.0.46"
burpsrc: "burp-{{ burp_version }}"
# previously:  burpurl: "https://github.com/grke/burp/archive/2.0.46.tar.gz"
burpurl: "https://github.com/grke/burp/archive/{{ burp_version }}.{{ burpsrcext }}"
# Directory that will be used as the location for the downloadsÂ§
download_dir: "{{ ansible_env.HOME }}/burp"

### Burp Server
burp_server_data: "{{ burp_home }}/data"
burp_server_clientconfdir: "/etc/burp/clientconfdir"
burp_server_autoupgrade_dir: "/etc/burp/autoupgrade/server"
burp_server_address: "0.0.0.0"
burp_server_port: "4971"
burp_server_status_address: "127.0.0.1"
burp_server_status_port: "4972"
burp_server_dedup_group: "global"
burp_server_protocol: "1"
burp_server_pidfile: "/var/run/burp.server.pid"
burp_server_hardlinked_archive: "0"
burp_server_working_dir_recovery_method: "delete"
burp_server_max_children: "4"
burp_server_max_status_children: "6"
burp_server_umask: "0022"
burp_server_syslog: "0"
burp_server_stdout: "1"
burp_server_client_can_delete: "1"
burp_server_client_can_force_backup: "1"
burp_server_client_can_list: "1"
burp_server_client_can_restore: "1"
burp_server_client_can_verify: "1"
burp_server_ratelimit: false
burp_server_network_timeout: false
# Changing default compression to lower level better for large deployments
# due to less CPU usage and fasters backups
burp_server_compression: zlib5
burp_server_version_warn: "1"
burp_server_ca_conf: "/etc/burp/CA.cnf"
burp_server_ca_name: "burpCA"
burp_server_ca_burp_ca: "/usr/sbin/burp_ca"
burp_server_ca_crl_check: "1"
burp_server_ssl_cert_ca: "/etc/burp/ssl_cert_ca-server.pem"
burp_server_ssl_cert: "/etc/burp/ssl_cert-server.pem"
burp_server_ssl_key: "/etc/burp/ssl_cert-server.key"
burp_server_ssl_dhfile: "/etc/burp/dhfile.pem"
burp_server_ssl_key_password: "password"
burp_server_script_pre: false
burp_server_scripts_pre_args: []
burp_server_script_post: false
burp_server_script_post_args: []
burp_server_monitor_cache: "1"
burp_server_timer_script: "/usr/share/burp/scripts/timer_script"
burp_server_timer_args:
  - 20h
  - Mon,Tue,Wed,Thu,Fri,00,01,02,03,04,05,19,20,21,22,23
  - Sat,Sun,00,01,02,03,04,05,06,07,08,17,18,19,20,21,22,23
burp_server_keep:
  - 7
### ---

## burp_server incexc profiles

profiles_templates:

  - name: profile_lnxsrv
    content:
      - "#hard_quota No permitir backups a clientes con mas de xxGb en el backup total"
      - "#hard_quota Do not allow to backup clients with more than xxGb in the whole backup"
      - "hard_quota=65Gb"
      - ""
      - "#soft_quota enviar WARNING backups a de clientes con mas de xxGb en el backup total"
      - "#soft_quota send WARNING to backups clients with more than xxGb in the whole backup"
      - "soft_quota=50Gb"
      - ""
      - ". lnxsrv_global_inclusions"
      - ". lnxsrv_global_exclusions"
      - ""
      - "dedup_group = lnxsrv"

  - name: profile_win6x
    content:
      - "#hard_quota No permitir backups a clientes con mas de xxGb en el backup total"
      - "#hard_quota Do not allow to backup clients with more than xxGb in the whole backup"
      - "hard_quota=65Gb"
      - ""
      - "#soft_quota enviar WARNING backups a de clientes con mas de xxGb en el backup total"
      - "#soft_quota send WARNING to backups clients with more than xxGb in the whole backup"
      - "soft_quota=50Gb"
      - ""
      - "# Due to issue: https://github.com/grke/burp/issues/501"
      - "# I'm moving some inclusions and reducing the way I'm using nested files and also not including anything that is not"
      - "# on all clients."
      - "# . win6x_global_inclusions"
      - "include_glob=C:/Users/*/Contacts"
      - "include_glob=C:/Users/*/Documents"
      - "include_glob=C:/Users/*/Favorites"
      - "include_glob=C:/Users/*/Links"
      - "include_glob=C:/Users/*/Desktop"
      - ""
      - ". win6x_global_exclusions"
      - ". video_exclusions"
      - ". audio_exclusions"
      - ""
      - "dedup_group = win6x"

# if burpsrv_agent: true
### Burp UI Agent
#[Global]
burp_agent_global_port: "5001"
burp_agent_global_bind: "0.0.0.0"
burp_agent_global_ssl: "false"
burp_agent_global_version: "2"
burp_agent_global_password: "password"
#[Security]
burp_agent_security_includes: "/etc/burp"
burp_agent_security_enforce: "false"
burp_agent_security_revoke: "true"
#[Experimental]
burp_agent_experimental_zip64: "false"
#[Backend]
burp_agent_backend_burpbin: "/usr/sbin/burp"
burp_agent_backend_stripbin: "/usr/bin/vss_strip"
burp_agent_backend_tmpdir: "/tmp"
burp_agent_backend_timeout: "60"
# Burp UI pip packages
# Install burpui from a different source
# ex: burpsrv_pip_burpui: "https://burpui.ziirish.me/builds/burp-ui.dev.tar.gz"
burp_agent_pip_burpui: "burp-ui"
burpui_pip_packages:
  - { name: "{{ burp_agent_pip_burpui}}", version: 0.4.4 }
burp_agent_pip_present:
  - "pip>=9"
  - "cffi>=1.7"
  - "gevent>=1.2"
  - "ujson>=1.35"
  - "urllib3>=1.19" # required to avoid issues with get_url module
  - "ndg-httpsclient>=0.4.2" # required to avoid issues with get_url module
  - "pyasn1"
  - "requests[security]>=2.12"  # required to avoid issues with get_url module
### ---

### Supervisor 
# Burp Agent
burp_sv_agent_priority: "40"
burp_sv_agent_directory: "/tmp"
burp_sv_agent_command: "{{ pip_installed_exe_bin_path }}/bui-agent -v -c /etc/burp/buiagent.cfg"
burp_sv_agent_user: "root"
burp_sv_agent_autostart: "true"
burp_sv_agent_autorestart: "true"
burp_sv_agent_stdout_logfile: "/var/log/supervisor/%(program_name)s.log"
burp_sv_agent_stderr_logfile: "/var/log/supervisor/%(program_name)s.log"
# Burp Restore
burp_sv_restore_priority: "30"
burp_sv_restore_directory: "/tmp"
burp_sv_restore_command: "/usr/sbin/burp -F -c /etc/burp/burp-restore.conf"
burp_sv_restore_user: "root"
burp_sv_restore_autostart: "true"
burp_sv_restore_autorestart: "true"
burp_sv_restore_stdout_logfile: "/var/log/supervisor/%(program_name)s.log"
burp_sv_restore_stderr_logfile: "/var/log/supervisor/%(program_name)s.log"
# Burp Server
burp_sv_server_priority: "20"
burp_sv_server_directory: "/tmp"
burp_sv_server_command: "/usr/sbin/burp -F -c /etc/burp/burp-server.conf"
burp_sv_server_user: "root"
burp_sv_server_autostart: "true"
burp_sv_server_autorestart: "true"
burp_sv_server_stdout_logfile: "/var/log/supervisor/%(program_name)s.log"
burp_sv_server_stderr_logfile: "/var/log/supervisor/%(program_name)s.log"
### ---

# if burp_manual_delete_enabled: true
### Manual Delete
burp_trash: "{{ burp_home }}/trash"
burp_logs: "/var/log/burp"
burp_cron_delete:
  - { minute: "00", hour: "03", dow: "*" }
### ---

# if burpsrv_local_client: true
### Burp Client
burp_client_pidfile: "/var/run/burp.pid"
burp_client_password: "password"
burp_client_ca_csr_dir: "/etc/burp/CA-client"
burp_client_ssl_cert_ca: "/etc/burp/ssl_cert_ca-monitor.pem"
burp_client_ssl_cert: "/etc/burp/ssl_cert-monitor.pem"
burp_client_ssl_key: "/etc/burp/ssl_cert-monitor.key"
### ---

# if burp_module_restore: true
### Burp Restore
burp_restore_address: "0.0.0.0"
burp_restore_port: "4973"
burp_restore_status_address: "127.0.0.1"
burp_restore_status_port: "4974"
burp_restore_pidfile: "/var/run/burp.restore.pid"
burp_restore_clients:
  - monitor
### ---

